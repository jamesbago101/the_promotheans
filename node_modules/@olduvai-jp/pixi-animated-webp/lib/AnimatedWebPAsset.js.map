{"version":3,"file":"AnimatedWebPAsset.js","sources":["../src/AnimatedWebPAsset.ts"],"sourcesContent":["import { DOMAdapter, extensions, ExtensionType, path } from 'pixi.js';\nimport { AnimatedWebP, AnimatedWebPOptions } from './AnimatedWebP';\n\nimport type { AssetExtension } from 'pixi.js';\n\n/**\n * Handle the loading of WebP images. Registering this loader plugin will\n * load all `.webp` images as an ArrayBuffer and transform into an\n * AnimatedWebP object.\n * @ignore\n */\nconst AnimatedWebPAsset = {\n    extension: ExtensionType.Asset,\n    detection: {\n        test: async () => true,\n        add: async (formats) => [...formats, 'webp'],\n        remove: async (formats) => formats.filter((format) => format !== 'webp'),\n    },\n    loader: {\n        name: 'animatedWebpLoader',\n        extension: {\n            type: ExtensionType.LoadParser,\n            priority: 10,\n        },\n        test: (url) =>\n        {\n            const isWebP = path.extname(url) === '.webp';\n\n            return isWebP;\n        },\n        load: async (url, asset) =>\n        {\n            try\n            {\n                const response = await DOMAdapter.get().fetch(url);\n                const buffer = await response.arrayBuffer();\n                const result = await AnimatedWebP.fromBuffer(buffer, asset?.data);\n\n                return result;\n            }\n            catch (error)\n            {\n                console.error('Error in AnimatedWebPAsset loader:', error);\n                throw error;\n            }\n        },\n        unload: async (asset) =>\n        {\n            asset.destroy();\n        },\n    }\n} as AssetExtension<AnimatedWebP, AnimatedWebPOptions>;\n\nextensions.add(AnimatedWebPAsset);\nexport { AnimatedWebPAsset };\n"],"names":["ExtensionType","path","DOMAdapter","AnimatedWebP","extensions"],"mappings":";;;;;AAWA,MAAM,iBAAoB,GAAA;AAAA,EACtB,WAAWA,qBAAc,CAAA,KAAA;AAAA,EACzB,SAAW,EAAA;AAAA,IACP,MAAM,YAAY,IAAA;AAAA,IAClB,KAAK,OAAO,OAAA,KAAY,CAAC,GAAG,SAAS,MAAM,CAAA;AAAA,IAC3C,MAAA,EAAQ,OAAO,OAAY,KAAA,OAAA,CAAQ,OAAO,CAAC,MAAA,KAAW,WAAW,MAAM,CAAA;AAAA,GAC3E;AAAA,EACA,MAAQ,EAAA;AAAA,IACJ,IAAM,EAAA,oBAAA;AAAA,IACN,SAAW,EAAA;AAAA,MACP,MAAMA,qBAAc,CAAA,UAAA;AAAA,MACpB,QAAU,EAAA,EAAA;AAAA,KACd;AAAA,IACA,IAAA,EAAM,CAAC,GACP,KAAA;AACI,MAAA,MAAM,MAAS,GAAAC,YAAA,CAAK,OAAQ,CAAA,GAAG,CAAM,KAAA,OAAA,CAAA;AAErC,MAAO,OAAA,MAAA,CAAA;AAAA,KACX;AAAA,IACA,IAAA,EAAM,OAAO,GAAA,EAAK,KAClB,KAAA;AACI,MACA,IAAA;AACI,QAAA,MAAM,WAAW,MAAMC,kBAAA,CAAW,GAAI,EAAA,CAAE,MAAM,GAAG,CAAA,CAAA;AACjD,QAAM,MAAA,MAAA,GAAS,MAAM,QAAA,CAAS,WAAY,EAAA,CAAA;AAC1C,QAAA,MAAM,SAAS,MAAMC,yBAAA,CAAa,UAAW,CAAA,MAAA,EAAQ,OAAO,IAAI,CAAA,CAAA;AAEhE,QAAO,OAAA,MAAA,CAAA;AAAA,eAEJ,KAAP,EAAA;AAEI,QAAQ,OAAA,CAAA,KAAA,CAAM,sCAAsC,KAAK,CAAA,CAAA;AACzD,QAAM,MAAA,KAAA,CAAA;AAAA,OACV;AAAA,KACJ;AAAA,IACA,MAAA,EAAQ,OAAO,KACf,KAAA;AACI,MAAA,KAAA,CAAM,OAAQ,EAAA,CAAA;AAAA,KAClB;AAAA,GACJ;AACJ,EAAA;AAEAC,kBAAA,CAAW,IAAI,iBAAiB,CAAA;;;;"}